	SUBROUTINE PLOTF
C	PROGRAM PLOT.FTN FOR PLOT ON "VISUAL 550" TERMINAL
	REAL*8 XX,YY,ERR,FACT,XMIN,XMAX
	CHARACTER*20 FILE
	CHARACTER*80 CHARA
	CHARACTER*1 ICHAR,YES
	LOGICAL*1 AUTO
	DIMENSION X(200),Y(200),ER(200)
	COMMON /PLOT/ XX(10,200),YY(10,200),ERR(10,200),NUMB(10),
     +	KIN(10),FACT(10),XMIN,XMAX,ND
	ITERM=1
	CALL INITT(0)
	CALL TERM(ITERM,1024)
        CALL SETBUF(3)
C107	WRITE(6,*)' TYPE 0  FOR LIN , 1 FOR LOG SCALE'
107	LIN=0
	AUTO=.FALSE.
	DO 26 K=1,ND
	NUM=NUMB(K)
	DO 26 I=1,NUM
	YY(K,I)=YY(K,I)*FACT(K)
	ERR(K,I)=ERR(K,I)*FACT(K)
26	CONTINUE
	IF(LIN.EQ.1)THEN
	write(6,*) ' TYPE LOWEST AND HIGHEST POWER OF 10 FOR Y AXIS'
	write(6,*) '                        (0,0) FOR AUTO SCALING'
	READ(5,*)IMI,IMA
	IF(IMI.EQ.0.AND.IMA.EQ.0)THEN
	AUTO=.TRUE.
	ELSE
	AMIN=IMI
	AMAX=IMA
	END IF
	ELSE
	END IF
	IF(LIN.EQ.0)THEN
	WRITE(6,*) ' TYPE MIN AND MAX SCALE ON Y AXIS'
	WRITE(6,*) '                 (0,0) FOR AUTO SCALING'
	READ(5,*)AMIN,AMAX
	AB1=ABS(AMIN)
	AB2=ABS(AMAX)
	A10=10.**-6
	IF(AB1.LT.A10.AND.AB2.LT.A10)AUTO=.TRUE.
	ELSE
	END IF
	IF(AUTO)THEN
	AMAX=YY(1,1)
	AMIN=YY(1,1)
	DO 11 K=1,ND
	NUM=NUMB(K)
	DO 11 I=1,NUM
	IF(YY(K,I).GT.AMAX)AMAX=YY(K,I)
	IF(YY(K,I).LT.AMIN)AMIN=YY(K,I)
11	CONTINUE
	IF(LIN.NE.0)THEN
	AMI=ALOG10(AMIN)
	AMA=ALOG10(AMAX)
	IF(AMI.LT.0.)AMI=AMI-1
	IF(AMA.GT.0.)AMA=AMA+1
	IMI=AMI
	IMA=AMA
	AMIN=IMI
	AMAX=IMA
	ELSE
	AMIN=0.
	AMAX=AMAX+(0.1*AMAX)
	END IF
	ELSE
	END IF
	xxmin=xmin
	xxmax=xmax
	CALL ANMODE
900	CALL ERASE
	IF(LIN.EQ.1)CALL LAXIS(150,100,600,IMI,IMA,1)
	IF(LIN.EQ.0)CALL AXIS(150,100,600,AMIN,AMAX,2,-1,1)
	IF(LIN.EQ.0)CALL AXIS(950,100,600,AMIN,AMAX,2,-1,-1)
	CALL AXIS(150,100,800,xXMIN,xXMAX,0,1,1)
	IF(LIN.EQ.1)CALL LAXIS(950,100,600,IMI,IMA,-1)
	CALL AXIS(150,700,800,xXMIN,xXMAX,0,1,-1)
	DO 30 K=1,ND
	NUM=NUMB(K)
	DO 28 I=1,NUM
	X(I)=XX(K,I)
	Y(I)=YY(K,I)
	ER(I)=ERR(K,I)
28	CONTINUE
	KIND=KIN(K)
	CALL LINE(150,100,800,600,X,Y,ER,NUM,xXMIN,xXMAX,AMIN,AMAX,KIND,LIN)
30	CONTINUE
	CALL MOVABS(100,100)
50	CALL SCURSR(IC,IX,IY)
	CALL MOVABS(IX,IY)
	if (ic .gt. 96) ic = ic - 32
	ichar = char(ic)
	IF(ICHAR.EQ.'S')GO TO 160
	IF(ICHAR.EQ.'X')GOTO 160
	IF(ICHAR.EQ.'R')GO TO 170
	IF(ICHAR.EQ.'W')GOTO 170
	IF(ICHAR.EQ.'C')GO TO 180
	GO TO 50
160	GO TO 70
170	CALL ANMODE
        call anmode
	READ(5,106)CHARA
	CALL MOVABS(IX,IY)
	IY1=IY
	GO TO 50
180	IY1=IY1-30
	CALL MOVABS(IX,IY1)
	CALL ANMODE
        call anmode
	READ(5,106)CHARA
	GO TO 50
106	FORMAT(A80)
70	CALL vtmode
        call vtmode
	RETURN
	END

